<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>tinydtls: crypto.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">tinydtls
   &#160;<span id="projectnumber">0.4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">crypto.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="global_8h_source.html">global.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="debug_8h_source.html">debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="numeric_8h_source.html">numeric.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="dtls_8h_source.html">dtls.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="crypto_8h_source.html">crypto.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ccm_8h_source.html">ccm.h</a>&quot;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
</div>
<p><a href="crypto_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab7ea6d487f3c6e67106df7f4d281804a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ab7ea6d487f3c6e67106df7f4d281804a">HMAC_UPDATE_SEED</a>(Context, Seed, Length)&#160;&#160;&#160;if (Seed) <a class="el" href="group__HMAC.html#ga1ef9c88a0a2053b442413a9cea3deb73">dtls_hmac_update</a>(Context, (Seed), (Length))</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a88e275b0be0af628c20c5b5676f00e4e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a88e275b0be0af628c20c5b5676f00e4e">dtls_cipher_context_new</a> ()</td></tr>
<tr class="memitem:ab8a3d28d68c78eaac5a539f904a54547"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ab8a3d28d68c78eaac5a539f904a54547">dtls_cipher_context_free</a> (<a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a> *ctx)</td></tr>
<tr class="memitem:adef91ac5653c22c8df6fecbcb29f90b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#adef91ac5653c22c8df6fecbcb29f90b8">dtls_hmac_storage_init</a> ()</td></tr>
<tr class="memitem:a86e6ce9d4b4afcef355836955697f52c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a86e6ce9d4b4afcef355836955697f52c">crypto_init</a> ()</td></tr>
<tr class="memitem:a0687f17f3913c35371d897a972f515aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a0687f17f3913c35371d897a972f515aa">dump</a> (unsigned char *, size_t)</td></tr>
<tr class="memitem:aea7bd0a10cf289c033216a97c0ee701e"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aea7bd0a10cf289c033216a97c0ee701e">dtls_p_hash</a> (<a class="el" href="group__HMAC.html#ga698cfa036e69361a93dcdd9b19579b23">dtls_hashfunc_t</a> h, const unsigned char *key, size_t keylen, const unsigned char *label, size_t labellen, const unsigned char *random1, size_t random1len, const unsigned char *random2, size_t random2len, unsigned char *<a class="el" href="dtls-client_8c.html#a095f0dd49eb8681e3a9d4632a98bb06e">buf</a>, size_t <a class="el" href="dtls-client_8c.html#ad6994903b3c19997ffcfdccb4431d308">buflen</a>)</td></tr>
<tr class="memitem:a5e47576e502b5a6255f1b489a4915512"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a5e47576e502b5a6255f1b489a4915512">dtls_prf</a> (const unsigned char *key, size_t keylen, const unsigned char *label, size_t labellen, const unsigned char *random1, size_t random1len, const unsigned char *random2, size_t random2len, unsigned char *<a class="el" href="dtls-client_8c.html#a095f0dd49eb8681e3a9d4632a98bb06e">buf</a>, size_t <a class="el" href="dtls-client_8c.html#ad6994903b3c19997ffcfdccb4431d308">buflen</a>)</td></tr>
<tr class="memitem:a1423f8111df1533241178461c10b50e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a1423f8111df1533241178461c10b50e3">dtls_mac</a> (<a class="el" href="structdtls__hmac__context__t.html">dtls_hmac_context_t</a> *hmac_ctx, const unsigned char *record, const unsigned char *packet, size_t length, unsigned char *<a class="el" href="dtls-client_8c.html#a095f0dd49eb8681e3a9d4632a98bb06e">buf</a>)</td></tr>
<tr class="memitem:aa80e52e289b3b307ee9f4c95e81a082a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aa80e52e289b3b307ee9f4c95e81a082a">dtls_ccm_init</a> (<a class="el" href="structaes128__ccm__t.html">aes128_ccm_t</a> *ccm_ctx, unsigned char *N, size_t length)</td></tr>
<tr class="memitem:a1c7fe12ad6f142724a1e645d8d401b48"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a1c7fe12ad6f142724a1e645d8d401b48">dtls_ccm_encrypt</a> (<a class="el" href="structaes128__ccm__t.html">aes128_ccm_t</a> *ccm_ctx, const unsigned char *src, size_t srclen, unsigned char *<a class="el" href="dtls-client_8c.html#a095f0dd49eb8681e3a9d4632a98bb06e">buf</a>, const unsigned char *aad, size_t la)</td></tr>
<tr class="memitem:a8a99b7f1d51f8506ebf645126af9fcbe"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a8a99b7f1d51f8506ebf645126af9fcbe">dtls_ccm_decrypt</a> (<a class="el" href="structaes128__ccm__t.html">aes128_ccm_t</a> *ccm_ctx, const unsigned char *src, size_t srclen, unsigned char *<a class="el" href="dtls-client_8c.html#a095f0dd49eb8681e3a9d4632a98bb06e">buf</a>, const unsigned char *aad, size_t la)</td></tr>
<tr class="memitem:af9e1d4aeb55b8367dd1c87a665165bef"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#af9e1d4aeb55b8367dd1c87a665165bef">dtls_pre_master_secret</a> (unsigned char *key, size_t keylen, unsigned char *result)</td></tr>
<tr class="memitem:af56d5c99667573a81f057d80d58e88b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#af56d5c99667573a81f057d80d58e88b4">dtls_cipher_set_iv</a> (<a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a> *ctx, unsigned char *iv, size_t length)</td></tr>
<tr class="memitem:acd9148cfb9ce6193629ec539d92ce2aa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#acd9148cfb9ce6193629ec539d92ce2aa">dtls_cipher_new</a> (<a class="el" href="global_8h.html#ada7e71454d685b693df45b2c1ea0c59b">dtls_cipher_t</a> cipher, unsigned char *key, size_t keylen)</td></tr>
<tr class="memitem:ac13b8a8dcef3a88e3e8891e29f28b142"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ac13b8a8dcef3a88e3e8891e29f28b142">dtls_cipher_free</a> (<a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a> *cipher_context)</td></tr>
<tr class="memitem:a95f39cd38babdcd4cec7815be02cbe39"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a95f39cd38babdcd4cec7815be02cbe39">dtls_encrypt</a> (<a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a> *ctx, const unsigned char *src, size_t length, unsigned char *<a class="el" href="dtls-client_8c.html#a095f0dd49eb8681e3a9d4632a98bb06e">buf</a>, const unsigned char *aad, size_t la)</td></tr>
<tr class="memitem:adabb4086b1c887827dc5241f01d1e7b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#adabb4086b1c887827dc5241f01d1e7b5">dtls_decrypt</a> (<a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a> *ctx, const unsigned char *src, size_t length, unsigned char *<a class="el" href="dtls-client_8c.html#a095f0dd49eb8681e3a9d4632a98bb06e">buf</a>, const unsigned char *aad, size_t la)</td></tr>
</table>
<h2>Macro Definition Documentation</h2>
<a class="anchor" id="ab7ea6d487f3c6e67106df7f4d281804a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HMAC_UPDATE_SEED</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">Context, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">Seed, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">Length&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;if (Seed) <a class="el" href="group__HMAC.html#ga1ef9c88a0a2053b442413a9cea3deb73">dtls_hmac_update</a>(Context, (Seed), (Length))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00079">79</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<h2>Function Documentation</h2>
<a class="anchor" id="a86e6ce9d4b4afcef355836955697f52c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00067">67</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8a99b7f1d51f8506ebf645126af9fcbe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t dtls_ccm_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structaes128__ccm__t.html">aes128_ccm_t</a> *&#160;</td>
          <td class="paramname"><em>ccm_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>srclen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>aad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>la</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00209">209</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1c7fe12ad6f142724a1e645d8d401b48"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t dtls_ccm_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structaes128__ccm__t.html">aes128_ccm_t</a> *&#160;</td>
          <td class="paramname"><em>ccm_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>srclen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>aad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>la</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00193">193</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa80e52e289b3b307ee9f4c95e81a082a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void dtls_ccm_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structaes128__ccm__t.html">aes128_ccm_t</a> *&#160;</td>
          <td class="paramname"><em>ccm_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00183">183</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab8a3d28d68c78eaac5a539f904a54547"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void dtls_cipher_context_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00047">47</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a88e275b0be0af628c20c5b5676f00e4e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a>* dtls_cipher_context_new </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00042">42</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac13b8a8dcef3a88e3e8891e29f28b142"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dtls_cipher_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a> *&#160;</td>
          <td class="paramname"><em>cipher_context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Releases the storage allocated by <a class="el" href="crypto_8c.html#acd9148cfb9ce6193629ec539d92ce2aa">dtls_cipher_new()</a> for <code>cipher_context</code> </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00284">284</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="acd9148cfb9ce6193629ec539d92ce2aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a>* dtls_cipher_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="global_8h.html#ada7e71454d685b693df45b2c1ea0c59b">dtls_cipher_t</a>&#160;</td>
          <td class="paramname"><em>code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a new <a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a> object for given <code>cipher</code>. The storage allocated for this object must be released using <a class="el" href="crypto_8c.html#ac13b8a8dcef3a88e3e8891e29f28b142">dtls_cipher_free()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">code</td><td>Code of the requested cipher (host byte order) </td></tr>
    <tr><td class="paramname">key</td><td>The encryption and decryption key. </td></tr>
    <tr><td class="paramname">keylen</td><td>Actual length of <code>key</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A new <a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a> object or <code>NULL</code> in case something went wrong (e.g. insufficient memory or wrong key length) </dd></dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00251">251</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="af56d5c99667573a81f057d80d58e88b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dtls_cipher_set_iv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the given cipher context <code>ctx</code> with the initialization vector <code>iv</code> of length <code>length</code>. </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00244">244</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="adabb4086b1c887827dc5241f01d1e7b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dtls_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>a_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>a_data_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypts the given buffer <code>src</code> of given <code>length</code>, writing the result to <code>buf</code>. The function returns <code>-1</code> in case of an error, or the number of bytes written. Note that for block ciphers, <code>length</code> must be a multiple of the cipher's block size. A return value between <code>0</code> and the actual length indicates that only <code>n-1</code> block have been processed. Unlike <a class="el" href="crypto_8c.html#a95f39cd38babdcd4cec7815be02cbe39">dtls_encrypt()</a>, the source and destination of <a class="el" href="crypto_8c.html#adabb4086b1c887827dc5241f01d1e7b5">dtls_decrypt()</a> may overlap.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The cipher context to use. </td></tr>
    <tr><td class="paramname">src</td><td>The buffer to decrypt. </td></tr>
    <tr><td class="paramname">length</td><td>The length of the input buffer. </td></tr>
    <tr><td class="paramname">buf</td><td>The result buffer. </td></tr>
    <tr><td class="paramname">aad</td><td>additional authentication data for AEAD ciphers </td></tr>
    <tr><td class="paramname">aad_length</td><td>actual size of <code>aad</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Less than zero on error, the number of decrypted bytes otherwise. </dd></dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00304">304</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a95f39cd38babdcd4cec7815be02cbe39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dtls_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdtls__cipher__context__t.html">dtls_cipher_context_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>aad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>aad_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Encrypts the specified <code>src</code> of given <code>length</code>, writing the result to <code>buf</code>. The cipher implementation may add more data to the result buffer such as an initialization vector or padding (e.g. for block cipers in CBC mode). The caller therefore must ensure that <code>buf</code> provides sufficient storage to hold the result. Usually this means ( 2 + <code>length</code> / blocksize ) * blocksize. The function returns a value less than zero on error or otherwise the number of bytes written.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The cipher context to use. </td></tr>
    <tr><td class="paramname">src</td><td>The data to encrypt. </td></tr>
    <tr><td class="paramname">length</td><td>The actual size of of <code>src</code>. </td></tr>
    <tr><td class="paramname">buf</td><td>The result buffer. <code>src</code> and <code>buf</code> must not overlap. </td></tr>
    <tr><td class="paramname">aad</td><td>additional data for AEAD ciphers </td></tr>
    <tr><td class="paramname">aad_length</td><td>actual size of <code>aad</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of encrypted bytes on success, less than zero otherwise. </dd></dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00289">289</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="adef91ac5653c22c8df6fecbcb29f90b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dtls_hmac_storage_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hmac_8c_source.html#l00066">66</a> of file <a class="el" href="hmac_8c_source.html">hmac.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1423f8111df1533241178461c10b50e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dtls_mac </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdtls__hmac__context__t.html">dtls_hmac_context_t</a> *&#160;</td>
          <td class="paramname"><em>hmac_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>record</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates MAC for record + cleartext packet and places the result in <code>buf</code>. The given <code>hmac_ctx</code> must be initialized with the HMAC function to use and the proper secret. As the DTLS mac calculation requires data from the record header, <code>record</code> must point to a buffer of at least <code>sizeof(dtls_record_header_t)</code> bytes. Usually, the remaining packet will be encrypted, therefore, the cleartext is passed separately in <code>packet</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hmac_ctx</td><td>The HMAC context to use for MAC calculation. </td></tr>
    <tr><td class="paramname">record</td><td>The record header. </td></tr>
    <tr><td class="paramname">packet</td><td>Cleartext payload to apply the MAC to. </td></tr>
    <tr><td class="paramname">length</td><td>Size of <code>packet</code>. </td></tr>
    <tr><td class="paramname">buf</td><td>A result buffer that is large enough to hold the generated digest. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00166">166</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="aea7bd0a10cf289c033216a97c0ee701e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t dtls_p_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__HMAC.html#ga698cfa036e69361a93dcdd9b19579b23">dtls_hashfunc_t</a>&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>labellen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>random1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>random1len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>random2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>random2len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Expands the secret and key to a block of DTLS_HMAC_MAX size according to the algorithm specified in section 5 of RFC 4346.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>Identifier of the hash function to use. </td></tr>
    <tr><td class="paramname">key</td><td>The secret. </td></tr>
    <tr><td class="paramname">keylen</td><td>Length of <code>key</code>. </td></tr>
    <tr><td class="paramname">seed</td><td>The seed. </td></tr>
    <tr><td class="paramname">seedlen</td><td>Length of <code>seed</code>. </td></tr>
    <tr><td class="paramname">buf</td><td>Output buffer where the result is XORed into The buffe must be capable to hold at least <code>buflen</code> bytes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The actual number of bytes written to <code>buf</code> or 0 on error. </dd></dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00083">83</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="af9e1d4aeb55b8367dd1c87a665165bef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t dtls_pre_master_secret </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generates pre_master_sercet from given PSK and fills the result according to the "plain PSK" case in section 2 of RFC 4279. Diffie-Hellman and RSA key exchange are currently not supported.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The shared key. </td></tr>
    <tr><td class="paramname">keylen</td><td>Length of <code>key</code> in bytes. </td></tr>
    <tr><td class="paramname">result</td><td>The derived pre master secret. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The actual length of <code>result</code>. </dd></dl>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00225">225</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5e47576e502b5a6255f1b489a4915512"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t dtls_prf </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>labellen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>random1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>random1len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>random2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>random2len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function implements the TLS PRF for DTLS_VERSION. For version 1.0, the PRF is P_MD5 ^ P_SHA1 while version 1.2 uses P_SHA256. Currently, the actual PRF is selected at compile time. </p>

<p>Definition at line <a class="el" href="crypto_8c_source.html#l00149">149</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a class="anchor" id="a0687f17f3913c35371d897a972f515aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dump </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>dump as narrow string of hex digits </p>

<p>Definition at line <a class="el" href="dtls_8c_source.html#l02486">2486</a> of file <a class="el" href="dtls_8c_source.html">dtls.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jul 22 2013 14:58:58 for tinydtls by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
